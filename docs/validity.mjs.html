<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: validity.mjs</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: validity.mjs</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Contains logic to check username and password validity
 * @module validity
*/

/**
 * Checks if username meets username validity requirements
 * @function checkUsername
 * @param {String} username - Username to validate
 * @returns {Boolean}
 * */
function checkUsername(username) {
  const email_reg = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/;

  if (email_reg.test(username)) {
    console.log("Valid email address");
    return true;
  } else {
    console.log("Invalid email address");
    return false;
  }
}

/**
 * Checks if pass meets password complexity requirnments
 * @function checkPasswordFormat
 * @param {String} pass - Password to validate
 * @returns {Boolean}
 * */
function checkPasswordFormat(pass) {
  const cap_reg = /[A-Z]/;
  const low_reg = /[a-z]/;
  const num_reg = /[0-9]/;
  const spec_reg = /[`!@#$%^&amp;*()_+\-=[\]{};':"\\|,.&lt;>/?~]/;

  if (pass.length != 8) {
    return false;
  }

  if (!cap_reg.test(pass)) {
    return false;
  }

  if (!low_reg.test(pass)) {
    return false;
  }

  if (!num_reg.test(pass)) {
    return false;
  }

  if (!spec_reg.test(pass)) {
    return false;
  }

  return true;
}

/**
 * Checks if url is a valid url
 * @function checkURL
 * @param {String} url - Url to validate
 * @returns {Boolean}
 * */
function checkURL(url) {
  const url_reg =
    /((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&amp;=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&amp;=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w-_]*)?\??(?:[-+=&amp;;%@.\w_]*)#?(?:[\w]*))?)/;

  if (url_reg.test(url)) {
    console.log("Valid url");
    return true;
  } else {
    console.log("Invalid url");
    return false;
  }
}

/**
 * Checks if thumbnail is a valid image link
 * @function checkThumbnail
 * @param {String} thumbnail - Thumbnail Url to validate
 * @returns {Boolean}
 * */
function checkThumbnail(thumbnail) {
  const thumbnail_reg =
    /^https?:\/\/(.+\/)+.+(\.(gif|png|jpg|jpeg|webp|svg|psd|bmp|tif))$/i;

  if (thumbnail_reg.test(thumbnail)) {
    console.log("Valid thumnbail");
    return true;
  } else {
    console.log("Invalid thumbnail");
    return false;
  }
}

/**
 * Sanitize fields of videos based on the role of the client
 * @function sanitizeVideos
 * @param {Number} role - Role of user
 * @param {Array} videos - Unsanitized list of videos
 * @returns {Array} - Sanitized list of videos
 */
function sanitizeVideos(role, videos) {
  let result = Object.entries(videos).map((video) => {
    console.log("Video.name: ");
    console.log(video[1]);
    let sanitized = {
      name: video[1].name,
      url: video[1].url,
      thumbnail: video[1].thumbnail,
    };

    if (role == 2) {
      // Marketing Manager
      sanitized.likes = video[1].likes;
      sanitized.dislikes = video[1].dislikes;
    } else if (role == 1) {
      // Content Editor
      sanitized.comment = video[1].comment;
    }
    console.log("Sanitized: ");
    console.log(sanitized);
    return sanitized;
  });

  console.log(result);
  return result;
}

export {checkUsername, checkPasswordFormat, checkURL, checkThumbnail, sanitizeVideos}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-api.html">api</a></li><li><a href="module-middleware.html">middleware</a></li><li><a href="module-mongo.html">mongo</a></li><li><a href="module-validity.html">validity</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Wed Apr 30 2025 14:11:50 GMT-0800 (Alaska Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
